cmake_minimum_required(VERSION 3.27)

set(CMAKE_CXX_STANDARD 17)

project(BrickSeparator)

add_executable(BrickSeparator WIN32
    filesystem/FileSystem.cpp
    filesystem/RESMount.cpp
    filesystem/RFDMount.cpp

    formats/CRDFile.cpp
    formats/CSPFile.cpp
    formats/LLSFile.cpp
    formats/Model3DFile.cpp
    formats/RESFile.cpp
    formats/RFDFile.cpp

    panels/CRDInfoPanel.cpp
    panels/CSPInfoPanel.cpp
    panels/InfoPanel.cpp
    panels/LLSInfoPanel.cpp
    panels/Model3DInfoPanel.cpp

    App.cpp
    BrickSeparatorBase.cpp # Generated by wxFormBuilder
    MainFrame.cpp
)

target_include_directories(BrickSeparator PRIVATE ${CMAKE_CURRENT_LIST_DIR})

find_package(wxWidgets REQUIRED COMPONENTS base core gl)
find_package(OpenGL REQUIRED)
target_link_libraries(BrickSeparator PRIVATE wxWidgets::wxWidgets OpenGL::GL)

# set DPI awareness for windows/vs
set_property(TARGET BrickSeparator PROPERTY VS_DPI_AWARE "PerMonitor")

install(TARGETS BrickSeparator)

if(WIN32)
    # install library dependencies
    install(TARGETS BrickSeparator
        RUNTIME_DEPENDENCIES
            DIRECTORIES ${wxWidgets_LIB_DIR}
            # exclude system files
            PRE_EXCLUDE_REGEXES "api-ms-" "ext-ms-" "vcruntime"
            POST_EXCLUDE_REGEXES ".*system32/.*\\.dll"
    )
endif()